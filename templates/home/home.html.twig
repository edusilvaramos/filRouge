{% extends 'base.html.twig' %}

{% block title %}home
{% endblock %}
{% block body %}

	<div class="d-flex justify-content-end align-items-end">
		<a href="{{ path('outputPdf') }}" class="btn btn-primary btn-sm fs-5 m-3 align-self-end">Telecharger le rapport PDF</a>
	</div>
	<div class="container mt-5 px-3 px-md-5 mb-5">
		<div class="row">
			<div>
				{{ render(path('app_statistiques')) }}
			</div>
		</div>
	</div>
	{# visao geral #}

	<div class="container-fluid w-75 mt-5 mb-5">
		<h1 class="text-center text-primary mb-4">Projects</h1>
		<div class="row g-4 flex-column">
			{% for project in projects %}
				<div class="card shadow-sm mb-4">
					<div class="card-body">

						<div class="d-flex justify-content-between gap-2">
							<div>
								<h5 class="card-title text-primary">{{ project.projectName }}</h5>
								<a href="{{ path('app_project_show', {'id': project.id}) }}">
									<img {% if project.imageProject %} src="{{ project.imageProject }}" {% else %} src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT-sa_j6xK3XyQIJvwUpDEXYzExEGNAcXT1jQ&s" {% endif %} alt="Project Image" class="card-img-top mb-3" style="height: 200px; width: 500px ; object-fit: cover;">
								</a>
							</div>
							<div class="col-6">
								<h6 class="">Tâches associées :</h6>
								<ul class="list-group">
									{% for task in tasksByProject[project.id] %}
										<li class="list-group-item d-flex justify-content-between align-items-center">
											<div>
												<strong>{{ task.title }}</strong>
												–
												{{ task.descriptionTask }}
												<span class="badge {% if task.flagTask == 'completed' %}bg-success{% else %}bg-warning{% endif %} ms-2">
													{% if task.flagTask == 0 %}
														pending
													{% else %}
														{{ task.flagTask }}
													{% endif %}


												</span>
											</div>
											<a href="{{ path('app_task_show', { id: task.id }) }}" class="btn btn-sm btn-outline-primary">Voir</a>
										</li>
									{% else %}
										<li class="list-group-item text-muted">Aucune tâche associée.</li>
									{% endfor %}
								</ul>
							</div>


						</div>

					</div>
				</div>
			{% else %}
				<div class="col-12">
					<p class="text-center text-danger fs-5">No projects found.</p>
				</div>
			{% endfor %}
		</div>
	</div>


{% endblock %}
